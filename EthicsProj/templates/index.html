<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Media Detector</title>

    <!-- Bootstrap 5 -->
    <link 
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet">

    <style>
        body {
            background-color: #f8f9fa;
        }
        .card-hover:hover {
            transform: translateY(-3px);
            transition: 0.2s;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        textarea {
            width: 100%;
        }
        /* Dropzone styling for file inputs */
        .dropzone {
            border: 2px dashed rgba(0,0,0,0.08);
            border-radius: 8px;
            min-height: 140px;
            background-color: #fff;
            transition: background-color 0.15s, border-color 0.15s;
        }
        .dropzone.dragover {
            background-color: rgba(13,110,253,0.06);
            border-color: rgba(13,110,253,0.5);
        }
        .dropzone .dropzone-content {
            pointer-events: none; /* allow the label to handle clicks */
        }
        .dropzone .file-name {
            font-size: 0.9rem;
            color: #333;
            word-break: break-all;
        }
    </style>
</head>
<body>

<nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-4">
    <div class="container">
        <a class="navbar-brand" href="/">AI Media Detector</a>
    </div>
</nav>

<div class="container">
    <h1 class="text-center mb-4">Analyze Text, Images, or Videos</h1>

    <div class="row g-4">

        <!-- TEXT BOX -->
        <div class="col-md-4 d-flex">
            <div class="card card-hover shadow-sm h-100 w-100">
                <div class="card-body d-flex flex-column">
                    <h4 class="card-title">Analyze Text</h4>
                    <form action="/analyze_text" method="POST" class="d-flex flex-column flex-grow-1">
                        <textarea class="form-control mb-3 flex-grow-1" 
                                  name="text_input" rows="6"
                                  placeholder="Paste text or URL here..."></textarea>
                        <button type="submit" class="btn btn-primary w-100 mt-auto">Analyze</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- IMAGE BOX -->
        <div class="col-md-4 d-flex">
            <div class="card card-hover shadow-sm h-100 w-100">
                <div class="card-body d-flex flex-column">
                    <h4 class="card-title">Analyze Image</h4>
                    <form action="/analyze_image" method="POST" enctype="multipart/form-data" class="d-flex flex-column flex-grow-1">
                        <div class="dropzone mb-3 d-flex align-items-center justify-content-center" data-input-name="image_file" role="button">
                            <input class="d-none drop-input" type="file" name="image_file" accept="image/*">
                            <div class="dropzone-content text-center p-3">
                                <p class="mb-1 fw-semibold">Click or drag & drop an image here</p>
                                <small class="text-muted">PNG / JPG — recommended max 10MB</small>
                                <div class="file-name mt-2"></div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-success w-100 mt-auto">Analyze</button>
                    </form>
                </div>
            </div>
        </div>

        <!-- VIDEO BOX -->
        <div class="col-md-4 d-flex">
            <div class="card card-hover shadow-sm h-100 w-100">
                <div class="card-body d-flex flex-column">
                    <h4 class="card-title">Analyze Video</h4>
                    <form action="/analyze_video" method="POST" enctype="multipart/form-data" class="d-flex flex-column flex-grow-1">
                        <div class="dropzone mb-3 d-flex align-items-center justify-content-center" data-input-name="video_file" role="button">
                            <input class="d-none drop-input" type="file" name="video_file" accept="video/*">
                            <div class="dropzone-content text-center p-3">
                                <p class="mb-1 fw-semibold">Click or drag & drop a video here</p>
                                <small class="text-muted">MP4 / MOV — smaller is faster to analyze</small>
                                <div class="file-name mt-2"></div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-danger w-100 mt-auto">Analyze</button>
                    </form>
                </div>
            </div>
        </div>

    </div>
</div>
<script>
    // Safer submit overlay: create and append DOM node instead of using innerHTML
    // Using innerHTML on document.body during submit can reparse/remove the form element
    // and may cancel the request in some browsers. Create an element and append it.
    (function () {
        const forms = document.querySelectorAll('form');
        forms.forEach(function (form) {
            form.addEventListener('submit', function () {
                const overlay = document.createElement('div');
                overlay.className = 'position-fixed top-0 start-0 w-100 h-100 bg-dark bg-opacity-75 d-flex justify-content-center align-items-center';
                const spinner = document.createElement('div');
                spinner.className = 'spinner-border text-light';
                spinner.setAttribute('role', 'status');
                spinner.style.width = '4rem';
                spinner.style.height = '4rem';
                overlay.appendChild(spinner);
                document.body.appendChild(overlay);
            });
        });
    })();
</script>
<script>
    // Dropzone behavior for file inputs: click to open file dialog, support drag & drop
    (function () {
        function initDropzones() {
            document.querySelectorAll('.dropzone').forEach(function (zone) {
                var input = zone.querySelector('.drop-input');
                var fileNameEl = zone.querySelector('.file-name');

                // Clicking the dropzone opens file picker
                zone.addEventListener('click', function () {
                    if (input) input.click();
                });

                // Show selected file name when input changes
                if (input) {
                    input.addEventListener('change', function (ev) {
                        var f = input.files && input.files[0];
                        if (f) {
                            fileNameEl.textContent = f.name + ' (' + Math.round(f.size/1024) + ' KB)';
                        } else {
                            fileNameEl.textContent = '';
                        }
                    });
                }

                // Drag & drop handlers
                zone.addEventListener('dragenter', function (e) {
                    e.preventDefault(); e.stopPropagation();
                    zone.classList.add('dragover');
                });
                zone.addEventListener('dragover', function (e) {
                    e.preventDefault(); e.stopPropagation();
                    zone.classList.add('dragover');
                });
                zone.addEventListener('dragleave', function (e) {
                    e.preventDefault(); e.stopPropagation();
                    zone.classList.remove('dragover');
                });
                zone.addEventListener('drop', function (e) {
                    e.preventDefault(); e.stopPropagation();
                    zone.classList.remove('dragover');
                    var dt = e.dataTransfer;
                    if (dt && dt.files && dt.files.length && input) {
                        // Use DataTransfer to set the input.files (supported in modern browsers)
                        try {
                            input.files = dt.files;
                            var f = dt.files[0];
                            fileNameEl.textContent = f.name + ' (' + Math.round(f.size/1024) + ' KB)';
                        } catch (err) {
                            // Fallback: create a DataTransfer if possible
                            try {
                                var dataTransfer = new DataTransfer();
                                for (var i=0;i<dt.files.length;i++) dataTransfer.items.add(dt.files[i]);
                                input.files = dataTransfer.files;
                                var f2 = input.files[0];
                                fileNameEl.textContent = f2.name + ' (' + Math.round(f2.size/1024) + ' KB)';
                            } catch (ex) {
                                console.warn('Drop to input failed', ex);
                            }
                        }
                    }
                });
            });
        }

        // Initialize on DOM ready
        if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', initDropzones);
        else initDropzones();
    })();
</script>
</body>
</html>
